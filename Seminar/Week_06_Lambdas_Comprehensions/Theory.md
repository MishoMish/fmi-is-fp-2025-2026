# –õ–∞–º–±–¥–∏, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏ list comprehensions

## 1. –õ–∞–º–±–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏

–ê–Ω–æ–Ω–∏–º–Ω–∞ (–±–µ–∑–∏–º–µ–Ω–Ω–∞) —Ñ—É–Ω–∫—Ü–∏—è, –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω–∞ –Ω–∞ –º—è—Å—Ç–æ:

```haskell
\x -> x + 1          -- —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—è—Ç–æ –ø—Ä–∏–±–∞–≤—è 1
\x y -> x + y        -- —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
\(x, y) -> x + y     -- –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –∫–æ—Ä—Ç–µ–∂
```

```haskell
ghci> (\x -> x * 2) 5           -- 10
ghci> map (\x -> x ^ 2) [1..5]  -- [1, 4, 9, 16, 25]
ghci> filter (\x -> x `mod` 3 == 0) [1..20]  -- [3, 6, 9, 12, 15, 18]
```

> üí° –õ–∞–º–±–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏—Ç–µ —Å–∞ —É–¥–æ–±–Ω–∏ –∫–æ–≥–∞—Ç–æ –Ω–∏ —Ç—Ä—è–±–≤–∞ –∫—Ä–∞—Ç–∫–∞, –µ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –±–µ–∑ –¥–∞ –π –¥–∞–≤–∞–º–µ –∏–º–µ.

---

## 2. –°–µ–∫—Ü–∏–∏ –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏

–í—Å–µ–∫–∏ –∏–Ω—Ñ–∏–∫—Å–µ–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–µ–≤—ä—Ä–Ω–µ –≤ —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è:

```haskell
(+ 3)    -- \x -> x + 3
(* 2)    -- \x -> x * 2
(> 5)    -- \x -> x > 5
(3 :)    -- \xs -> 3 : xs
(++ "!")  -- \s -> s ++ "!"
```

```haskell
ghci> map (+ 10) [1, 2, 3]       -- [11, 12, 13]
ghci> filter (< 5) [3, 7, 1, 9]  -- [3, 1]
ghci> map (++ "!") ["hi", "yo"]  -- ["hi!", "yo!"]
```

> ‚ö†Ô∏è –ó–∞ –∏–∑–≤–∞–∂–¥–∞–Ω–µ –≤–Ω–∏–º–∞–≤–∞–π—Ç–µ: `(- 3)` –µ **—á–∏—Å–ª–æ—Ç–æ** -3, –Ω–µ —Å–µ–∫—Ü–∏—è! –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ `subtract 3` –≤–º–µ—Å—Ç–æ.

---

## 3. –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏

–û–ø–µ—Ä–∞—Ç–æ—Ä—ä—Ç `(.)` –∫–æ–º–±–∏–Ω–∏—Ä–∞ –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏: –ø—ä—Ä–≤–æ –ø—Ä–∏–ª–∞–≥–∞ –¥—è—Å–Ω–∞—Ç–∞, –ø–æ—Å–ª–µ –ª—è–≤–∞—Ç–∞.

```haskell
(.) :: (b -> c) -> (a -> b) -> a -> c
(f . g) x = f (g x)
```

```haskell
ghci> ((*2) . (+3)) 5    -- (*2) (5+3) = 16
ghci> (head . reverse) [1,2,3]  -- last [1,2,3] = 3
ghci> map (negate . abs) [-3, 2, -5]  -- [-3, -2, -5]
```

–ö–æ–º–ø–æ–∑–∏—Ü–∏—è—Ç–∞ –µ –ø–æ–ª–µ–∑–Ω–∞ –∑–∞ **–±–µ–∑—Ç–æ—á–∫–æ–≤ —Å—Ç–∏–ª** (point-free style):

```haskell
-- –° –∞—Ä–≥—É–º–µ–Ω—Ç:
doubleAll xs = map (*2) xs

-- –ë–µ–∑—Ç–æ—á–∫–æ–≤:
doubleAll = map (*2)

-- –° –∞—Ä–≥—É–º–µ–Ω—Ç:
sumOfEvens xs = sum (filter even xs)

-- –ë–µ–∑—Ç–æ—á–∫–æ–≤:
sumOfEvens = sum . filter even
```

---

## 4. `curry`, `uncurry` –∏ `flip`

```haskell
curry   :: ((a, b) -> c) -> a -> b -> c    -- –∫–æ—Ä—Ç–µ–∂–Ω–∞ ‚Üí curry
uncurry :: (a -> b -> c) -> (a, b) -> c    -- curry ‚Üí –∫–æ—Ä—Ç–µ–∂–Ω–∞
flip    :: (a -> b -> c) -> b -> a -> c    -- —Ä–∞–∑–º–µ–Ω—è –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ç–µ
```

```haskell
ghci> uncurry (+) (3, 4)           -- 7
ghci> map (uncurry (+)) [(1,2), (3,4)]  -- [3, 7]
ghci> flip (:) [1,2] 3            -- [3,1,2]
ghci> flip div 10 100             -- 10  (100 `div` 10)
```

---

## 5. –û–ø–µ—Ä–∞—Ç–æ—Ä `$`

`$` –µ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∑–∞ –ø—Ä–∏–ª–∞–≥–∞–Ω–µ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å **–Ω–∞–π-–Ω–∏—Å—ä–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** ‚Äî –ø–æ–∑–≤–æ–ª—è–≤–∞ –∏–∑–±—è–≥–≤–∞–Ω–µ –Ω–∞ —Å–∫–æ–±–∏:

```haskell
($) :: (a -> b) -> a -> b
f $ x = f x
```

```haskell
-- –ë–µ–∑ $:
sum (filter even (map (*2) [1..10]))

-- –° $:
sum $ filter even $ map (*2) [1..10]
```

---

## 6. List Comprehensions

**List comprehensions** —Å–∞ —Å–∏–Ω—Ç–∞–∫—Ç–∏—á–Ω–∞ –∑–∞—Ö–∞—Ä –∑–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –æ—Ç `map` –∏ `filter`:

```haskell
[<–∏–∑—Ä–∞–∑> | <–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä>, <—É—Å–ª–æ–≤–∏–µ>, ...]
```

```haskell
ghci> [x * 2 | x <- [1..5]]            -- [2, 4, 6, 8, 10]
ghci> [x | x <- [1..20], even x]       -- [2, 4, 6, ..., 20]
ghci> [x ^ 2 | x <- [1..10], odd x]    -- [1, 9, 25, 49, 81]
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏

```haskell
ghci> [(x, y) | x <- [1..3], y <- ['a'..'c']]
-- [(1,'a'),(1,'b'),(1,'c'),(2,'a'),(2,'b'),(2,'c'),(3,'a'),(3,'b'),(3,'c')]

ghci> [x * y | x <- [1..3], y <- [10,20]]
-- [10, 20, 20, 40, 30, 60]
```

### –ó–∞–≤–∏—Å–∏–º–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏

```haskell
ghci> [(x, y) | x <- [1..5], y <- [x..5]]
-- [(1,1),(1,2),...,(1,5),(2,2),(2,3),...,(5,5)]
```

### Let –≤ comprehension

```haskell
ghci> [(name, avg) | (name, grades) <- students
                   , let avg = sum grades `div` length grades
                   , avg >= 5]
```

---

## 7. –ï–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç: comprehension ‚Üî map/filter

```haskell
-- Comprehension:
[x * 2 | x <- xs, even x]

-- –ï–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –Ω–∞:
map (* 2) (filter even xs)
```

```haskell
-- Comprehension:
[(x, y) | x <- xs, y <- ys]

-- –ï–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –Ω–∞:
concatMap (\x -> map (\y -> (x, y)) ys) xs
```

---

## –û–±–æ–±—â–µ–Ω–∏–µ

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –°–∏–Ω—Ç–∞–∫—Å–∏—Å | –ü—Ä–∏–º–µ—Ä |
|-----------|-----------|--------|
| –õ–∞–º–±–¥–∞ | `\x -> ...` | `\x -> x + 1` |
| –°–µ–∫—Ü–∏—è | `(op val)` | `(+3)`, `(>0)` |
| –ö–æ–º–ø–æ–∑–∏—Ü–∏—è | `f . g` | `sum . filter even` |
| `$` | `f $ x` | `sum $ map (*2) xs` |
| `curry`/`uncurry` | ‚Äî | `uncurry (+) (3,4)` |
| `flip` | ‚Äî | `flip div 10 100` |
| Comprehension | `[e \| x <- xs, p x]` | `[x^2 \| x <- [1..10], odd x]` |
